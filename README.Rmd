---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# Ripc

<!-- badges: start -->
[![R-CMD-check](https://github.com/OCHA-DAP/Ripc/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/OCHA-DAP/Ripc/actions/workflows/R-CMD-check.yaml)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- badges: end -->

The goal of Ripc is to provide access to [Integrated Food Security Phase
Classification](https://www.ipcinfo.org) (IPC) data. 

## Installation

You can install the Ripc like so:

``` r
# install.packages("remotes")
remotes::install_github("OCHA-DAP/Ripc")
```

The package is not currently available on CRAN.

## Usage

Ripc provides functionality to access IPC data stored directly on the [IPC
API](https://docs.api.ipcinfo.org). There are a wide set of functions detailed
further below, but most users will get the information they need from the
`ipc_get_population()` function which returns datasets of country-level,
group-level, and area-level analyses in a list.

```{r download, message = FALSE}
library(Ripc)

df_list <- ipc_get_population()
df_list$country
```

More details on the API are available below.

## IPC API

```{r child="vignettes/ipc-api.Rmd"}
```

## Humanitarian Data Exchange data

[![Lifecycle: deprecated](https://img.shields.io/badge/lifecycle-deprecated-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#deprecated)

Usage of functions to access data from the Humanitarian Data Exchange are
deprecated. These will be removed in future versions once the API access is
stable.

IPC data is stored on the [Humanitarian Data Exchange](https://data.humdata.org/dataset/ipc-country-data), and this package
provides a simple interface to pull this data directly. However, the data is
also stored in a format not readily usable for analysis or visualization. Thus,
this package also automatically wrangles the data into a format prepared for
analysis. This functionality is documented within `ipc_download()` and
`ipc_wrangle()` respectively.

For the user, all that is needed is a simple one liner.

```{r hdx-download, message = FALSE}
ipc_download()
```

## Memoisation

`ipc_get()`, the function that makes requests to the IPC API, has cached
functionality based on `memoise::memoise()` so that all of the
`ipc_get_...()` family of functions are cached in your local memory in a single
session. This means that once you've made a call to retrieve data from
the API, running an identical request will use the cached data rather than
re-request the data from the IPC database.

If you need to ensure that the Ripc package is making new requests to the API
each time is called, then you will need to run 
`memoise::forget(Ripc:::ipc_get)` to clear the cache prior to repeating a call.
See the documentation of the [memoise package](https://github.com/r-lib/memoise)
for more details.

## Help and issues

For any help, please file an issue on
[Github](https://github.com/OCHA-DAP/Ripc/issues). If the issue relates to
downloading the data from HDX, please refer to the [rhdx package](https://github.com/dickoa/rhdx).

